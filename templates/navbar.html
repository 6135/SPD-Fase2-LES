{% load static %}
{% load poll_extras %}
{% load notificacoes_extras %}
<nav class="navbar" role="navigation" aria-label="main navigation">
  <div class="navbar-brand">
    <a class="navbar-item logo" href="{% url 'home' %}">
      <img src="{% static 'img/logo-navbar.png' %}" alt="Dia Aberto">
    </a>

    <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false"
      data-target="navbarBasicExample">
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
      <span aria-hidden="true"></span>
    </a>
  </div>

  <div class="navbar-menu">
    <div class="navbar-start">

    {% if request.user|has_group:'Participante' %}
    <a href="{% url 'inscricoes:criar-inscricao' %}" class="navbar-item">
      Minha Inscrição
    </a>
    {% elif request.user|has_group:'Colaborador'%}
    <a href="{% url 'colaboradores:consultar-tarefas' %}" class="navbar-item">
      Minhas Tarefas
    </a> 
    {% elif request.user|has_group:'ProfessorUniversitario'%}
    <a href="/minhasatividades" class="navbar-item">
      Minhas Atividades
    </a>   
    {% elif request.user|has_group:'Coordenador'%}
    <a href="/minhasatividades" class="navbar-item">
      Atividades dos Departamentos
    </a>  
    <a href="/minhasatividades" class="navbar-item">
        Inscrições
      </a> 
      <a href="{% url 'utilizadores:consultar-utilizadores' %}" class="navbar-item">
        Utilizadores
      </a> 
      <a href="{% url 'consultarTarefa' %}" class="navbar-item">
        Tarefas
      </a>
    {% elif request.user|has_group:'Administrador'%}
      <a href="{% url 'configuracao:diasAbertos' %}" class="navbar-item">
        Dias Abertos
      </a> 
      <a href="{% url 'configuracao:verTransportes' %}" class="navbar-item">
        Transportes
      </a> 
      <a href="{% url 'inscricoes:consultar-inscricoes' %}" class="navbar-item">
        Inscrições
      </a> 
      <a href="{% url 'configuracao:verMenus' %}" class="navbar-item">
        Almoços
      </a>  
      <a href="{% url 'utilizadores:consultar-utilizadores' %}" class="navbar-item">
        Utilizadores
      </a> 
      <a href="{% url 'configuracao:verEdificios' %}" class="navbar-item">
        Edificios e Espaços
      </a> 
      <a href="{% url 'configuracao:verTemas' %}" class="navbar-item">
        Temas
      </a> 
    {% else %}
    <a href="" class="navbar-item">

    </a>
    {% endif %}
</div>
    
    
    <div class="navbar-end">
      <div class="navbar-item">
      {% if user.is_authenticated %}
        <div class="dropdown is-bottom-left is-mobile-modal">
          
          <div onclick="notificacoes()">
          <div role="button" class="dropdown-trigger">
            <span role="button">
              <div type="button" data-badge="0" class="button has-badge-rounded has-badge-warning is-text"
                style="margin-right: 0.9rem">
                <span>
                  <span class="icon">
                    <i class="mdi mdi-bell mdi-24px"></i>
                  </span>
                </span>
              </div>
            </span>
          </div>
</div>
        
        <div id="ver_notificacoes" class="modal">
          <div class="modal-background"></div>
          <div class="modal-card">
            <header class="modal-card-head">
              <p class="modal-card-title">Notificações</p>
              
              <button onclick="notificacoes()" class="delete" aria-label="close"></button>
              
            </header>
            <section class="modal-card-body">
             <nav class="panel">


  <p class="panel-tabs">
    <a  class="tablinks is-active" onclick="openNotificacoes(event, 'Todas')" >Todas</a>
    <a  class="tablinks" onclick="openNotificacoes(event, 'Novas')" >Novas</a>
    <a  class="tablinks" onclick="openNotificacoes(event, 'Anteriores')" >Anteriores</a>
  </p>
<div id="Todas" style="display:block" class="tabcontent">

{% for notificacao in request.user|get_notificacoes:"Todas" %}
 <a href="{% url 'notificacoes:detalhes-notificacao-automatica' notificacao.id %}" class="panel-block">
{% if notificacao.lida == False %}
<span class="icon has-text-info">
  <i class="fas fa-info-circle"></i>
  </span>
{% else %}
<span class="icon has-text-success">
  <i class="fas fa-check-square"></i>
</span>
  {% endif %}


      <p><strong>{{notificacao.titulo}}</strong></p>

  </a>

{%endfor%} 
</div>  


<div id="Novas" style="display:none" class="tabcontent">
{% for notificacao in request.user|get_notificacoes:"False" %}
  <a href="{% url 'notificacoes:detalhes-notificacao-automatica' notificacao.id %}" class="panel-block">
{% if notificacao.lida == False %}
<span class="icon has-text-info">
  <i class="fas fa-info-circle"></i>
  </span>
{% else %}
<span class="icon has-text-success">
  <i class="fas fa-check-square"></i>
</span>
  {% endif %}


      <p><strong>{{notificacao.titulo}}</strong></p>

  </a>

{%endfor%} 
</div>  
<div id="Anteriores" style="display:none" class="tabcontent">
{% for notificacao in request.user|get_notificacoes:"True" %}
 <a href="{% url 'notificacoes:detalhes-notificacao-automatica' notificacao.id %}" class="panel-block">
{% if notificacao.lida == False %}
<span class="icon has-text-info">
  <i class="fas fa-info-circle"></i>
  </span>
{% else %}
<span class="icon has-text-success">
  <i class="fas fa-check-square"></i>
</span>
  {% endif %}


      <p><strong>{{notificacao.titulo}}</strong></p>

  </a>

{%endfor%} 
</div>  




</nav>
            </section>
          </div>
        </div>

        <div class="dropdown is-right" onclick="event.currentTarget.classList.toggle('is-active')">
          <div class="dropdown-trigger">
            <span role="button" aria-haspopup="true" aria-controls="dropdown-menu6">
              <div type="button" data-badge="0" class="button has-badge-rounded has-badge-warning is-text"
                style="margin-right: 0.9rem">
                <span>
                  <span class="icon">
                    <i class="mdi mdi-message mdi-24px"></i>
                  </span>
                </span>
              </div>
            </span>
          </div>
          <div class="dropdown-menu" id="dropdown-menu6" role="menu" style="min-width: 23rem">
            <div class="dropdown-content">
              <div class="dropdown-item">
                Mensagem 1
              </div>
              <hr class="dropdown-divider">
              <div class="dropdown-item">
                Mensagem 2
              </div>
              <hr class="dropdown-divider">
              <div class="dropdown-item">
                Mensagem 3
              </div>
              <hr class="dropdown-divider">
              <div class="dropdown-item level">
                <div class="level-left">
                  <span class="icon">
                    <i class="mdi mdi-message-text"></i>
                  </span>
                  <a href={% url 'notificacoes:enviar-notificacao' %}>Nova mensagem</a>
                </div>
                <div class="level-right">
                  <small><a href={% url 'notificacoes:enviar-notificacao' %}>Ver todas as mensagens</a></small>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div onclick="definicoes()">
        <div id="dropdown_definicoes" class="dropdown is-right">
          <div role="button" class="dropdown-trigger">
            <span role="button">
              <div type="button" data-badge="0" class="button has-badge-rounded has-badge-warning is-text"
                style="margin-right: 0.9rem">
                <span>
                  <span class="icon">
                    <i class="mdi mdi-account-circle mdi-24px"></i>
                  </span>
                </span>
              </div>
            </span>
          </div>
          <div class="background"  aria-hidden="true"></div>
          <div class="dropdown-menu"  aria-hidden="true">
            <div role="menu" class="dropdown-content">
           
              <div role="menuitem" tabindex="0" class="dropdown-item">
                <a href="{% url 'utilizadores:alterar-utilizador' %}" role="listitem" tabindex="0" class="dropdown-item is-disabled">
                  <span class="icon" >
                    <i class="mdi mdi-account-edit mdi-24px" ></i> 
                  </span>

                <strong>Alterar dados de conta</strong>
                 
                 
                 </a>
                  
                <a href="" role="listitem" tabindex="0" class="dropdown-item">
                
                  <span class="icon" >
                    <i class="mdi mdi-bell-circle mdi-24px" ></i> 
                  </span>

                <strong>Gerir notificações</strong>
                
                
                </a>
                
                <a href="{% url 'utilizadores:alterar-password' %}" role="listitem" tabindex="0" class="dropdown-item is-disabled">

                  <span class="icon" >
                    <i class="mdi mdi-key-variant mdi-24px" ></i> 
                  </span>

                <strong>Alterar palavra-passe</strong>
                
                </a>



                <a href="{% url 'utilizadores:alterar-idioma' %}" role="listitem" tabindex="0" class="dropdown-item is-disabled">

                  <span class="icon" >
                    <i class="mdi mdi-web mdi-24px" ></i> 
                  </span>

                <strong>Idioma</strong>
                
                </a>

                
                
                  {% if request.user|has_group:'Participante'%}
                <a onclick="alert.render('Tem a certeza que pretende eliminar a sua conta?<br><br><b>Atenção!</b><br><br>A sua <b>incrição</b> será apagada permanentemente.','{% url 'utilizadores:apagar-conta'%}')"role="listitem" tabindex="0" class="dropdown-item is-disabled">
                    {% elif request.user|has_group:'Colaborador'%}
                <a onclick="alert.render('Tem a certeza que pretende eliminar a sua conta?<br><br><b>Atenção!</b><br><br>As suas <b>tarefas</b> deixarão de lhe estar atribuidas.','{% url 'utilizadores:apagar-conta'%}')"role="listitem" tabindex="0" class="dropdown-item is-disabled">
                    {% elif request.user|has_group:'ProfessorUniversitario'%}
                <a onclick="alert.render('Tem a certeza que pretende eliminar a sua conta?<br><br><b>Atenção!</b><br><br>As suas <b>atividades</b> serão apagadas permanentemente.','{% url 'utilizadores:apagar-conta'%}')"role="listitem" tabindex="0" class="dropdown-item is-disabled">
                    {% elif request.user|has_group:'Coordenador'%}
                <a onclick="alert.render('Tem a certeza que pretende eliminar a sua conta?<br><br><b>Atenção!</b><br><br> As <b>atividades dos departamentos</b> pelo qual está responsável serão apagadas permanentemente.<br><br>As <b>tarefas dos colaboradores</b> pelo qual está responsável serão apagadas permanentemente.','{% url 'utilizadores:apagar-conta'%}')"role="listitem" tabindex="0" class="dropdown-item is-disabled"> 
                    {% elif request.user|has_group:'Administrador'%}
                    {% if user|apagar_admin:user.id %}
                <a onclick="alert.render('Tem a certeza que pretende eliminar a sua conta?<br><br><b>Atenção!</b><br><br>Todas as suas <b>informações</b> serão apagadas permanentemente incluindo os <b>dados de configuração</b> do dia aberto pelo qual está responsável.','{% url 'utilizadores:apagar-conta'%}')"role="listitem" tabindex="0" class="dropdown-item is-disabled">
                    {% else %}
                    
                  <a onclick="alert.warning('Não pode apagar o seu perfil porque é o unico administrador do dia aberto neste momento.')"role="listitem" tabindex="0" class="dropdown-item is-disabled">   
                    {% endif %}
                    {% endif %}
                    {% comment %} <input type="hidden" id="del" name="variable" value="{% url 'utilizadores:apagar-conta'%}">  {% endcomment %}
                  
                  <span class="icon" >
                    <i class="mdi mdi-trash-can-outline mdi-24px" ></i> 
                  </span>
                <strong>Apagar Conta</strong>
                </a>



              </div>
            </div>
          </div>
        </div>
        </div>
        {% endif %}
        
        
        
        {% if user.is_authenticated %}
        <a href="{% url 'utilizadores:logout' %}">
        <div type="button" class="button">
          <span class="icon is-small">
            <i class="mdi mdi-login-variant"></i>
          </span>
          <span>Sair</span>
        </div>
        </a>
        {% else %}

         
         <div class="navbar-end">
          <div class="navbar-item">
            <div class="buttons">
            <a href="{% url 'utilizadores:escolher-perfil' %}">
              <bottom class="button is-primary">
                <strong>Registar</strong>
              </a>
            </a>
            </div>
          </div>
        </div>
        

        <a href="{% url 'utilizadores:login' %}">
        <div type="button" class="button">
          <span class="icon is-small">
            <i class="mdi mdi-login-variant"></i>
          </span>
          <span>Entrar</span>
        </div>
        </a>
        {% endif %}

      </div>
    </div>
  </div>
</nav>


{% block scripts %}
<script>



function definicoes() {
  var x = document.getElementById("dropdown_definicoes");
  if (x.className === "dropdown is-right") {
    x.className = "dropdown is-right is-active";
  } else {
    x.className = "dropdown is-right";
  }
}

function notificacoes() {
  var x = document.getElementById("ver_notificacoes");
  if (x.className === "modal") {
    x.className = "modal is-active";
  } else {
    x.className = "modal";
  }
}

function openNotificacoes(evt, cityName) {
  var i, tabcontent, tablinks;
  tabcontent = document.getElementsByClassName("tabcontent");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }
  tablinks = document.getElementsByClassName("tablinks");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" is-active", "");
  }
  document.getElementById(cityName).style.display = "block";
  evt.currentTarget.className += " active";
}
</script>



{% endblock scripts %}